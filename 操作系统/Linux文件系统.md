`VFS`主要思想在于引入了一个通用的文件模型，这个模型能够表示支持所有的文件系统。

- 通用文件模型：每个目录看作一个文件
- 特殊的非`Unix`基于磁盘的文件系统：存放的是目录而不是文件

本质上说，`Linux`内核并不能对一个特定的文件执行`read()`或`write`操作，而是使用指针，指针再访问具体文件系统的适当函数。

通用文件模型有面向对象的意思，不同的文件模型就相当于不同的实例，但其实使用`C语言`是实现的

## 通用文件模型的组成

**超级块**

存放已安装文件系统的有关信息。

如果是基于磁盘的文件系统，那么超级块存放在磁盘上的文件系统控制块

**索引节点**

存放具体文件的信息。

如果是基于磁盘的文件系统，这类对象存放在磁盘上的文件控制块。那么`索引节点对象`都有一个`索引节点号`，这个`号码`唯一的标识该文件

**文件**

存放打开文件与进程之间进行交互的有关信息，**这类信息仅当进程访问文件期间存放于内核内存中**

**目录项**

由于VFS会经常的执行目录相关的操作，比如切换到某个目录、路径名的查找等等，为了提高这个过程的效率，VFS引入了目录项的概念。一个路径的组成部分，不管是目录还是普通文件，都是一个目录项对象。`/`、`usr`、`bin`、`vim`都对应一个目录项对象。

不过目录项对象没有对应的磁盘数据结构，是VFS在遍历路径的过程中，将它们逐个解析成目录项对象。

- `VFS`为所有文件系统的实现提供了一个通用的接口、
- 最近最常使用的目录项对象被放在`目录项高速缓存中`的`磁盘高速缓存`(在内核内存中，而不是磁盘)





## 参考

- [浅谈Linux虚拟文件系统 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/69289429)
- [VFS(一) 虚拟文件系统概述 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/260949737)
- 《深入理解Linux内核》