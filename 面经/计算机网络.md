## 一次完整的HTTP请求过程

比如我们访问百度，`www.baidu.com`

- 我们需要知道该域名对应的IP，所以我们会向DNS服务器发送询问，DNS域名解析得到对应的IP地址
- 根据这个IP，找到对应的服务器，发起TCP的三次握手
- 建立TCP连接后发起HTTP请求
- 服务器响应HTTP请求，浏览器得到html代码
- 浏览器解析html代码，并请求html代码中的资源（如js、css图片等）（先得到html代码，才能去找这些资源）
- 断开连接（TCP四次挥手）

## HTTP请求报文的格式

HTTP请求由请求行、请求头部、空行和请求体四个部分组成

- 请求行：请求方法，访问的资源URL，使用的HTTP版本；GET和POST是最常见的HTTP方法，除此以外还 包括DELETE、HEAD、OPTIONS、PUT、TRACE。
- 请求头包含一些属性（首部字段），格式为“属性名:属性值”，服务端据此获取客户端的信息，主要有cookie、host、 connection、accept-language、accept-encoding、user-agent。
- 请求体：用户的请求数据如用户名，密码等。

```C
POST /xxx HTTP/1.1 请求行
Accept:image/gif.image/jpeg, 请求头部
Accept-Language:zh-cn
Connection:Keep-Alive
Host:localhost
User-Agent:Mozila/4.0(compatible;MSIE5.01;Window NT5.0)
Accept-Encoding:gzip,deflate
空行
username=dabin 请求体
```

## HTTP响应报文格式

HTTP响应也由四个部分组成，分别是：状态行、响应头、空行和响应体。 

- 状态行：协议版本，状态码及状态描述。 
- 响应头：connection、content-type、content-encoding、content-length、set-cookie、Last-Modified，、Cache-Control、Expires。 
- 响应体：服务器返回给客户端的内容。

```C
HTTP/1.1 200 OK
Server:Apache Tomcat/5.0.12
Date:Mon,6Oct2003 13:23:42 GMT
Content-Length:112
    
<html>
<body>响应体</body>
</html>
```

## HTTP请求方法

客户端发送的 请求报文 第一行为请求行，包含了方法字段： 根据HTTP标准，HTTP请求可以使用多种请求方法。

- `HTTP/1.0`定义了三种请求方法：`GET`、`POST`和`HEAD`方法 

- `HTTP/1.1`新增了六种请求方法：`OPTIONS`、`PUT`、`PATCH`、`DELETE`、`TRACE`和`CONNECT`方法
- GET：获取资源，用来请求访问已被URI识别的资源
- POST：传输实体主体，GET也可以，但是一般不使用GET（GET会在输入栏看到传输内容）
- PUT：传输文件，HTTP/1.1的PUT方法不带验证机制，任何人都可以上传文件，存在安全问题，一般都不使用
- HEAD：获得报文首部，和GET方法一样，只是不返回报文主体部分，用于确认URI的有效性及资源更新的日期时间等
- DELETE：删除文件，HTTP/1.1的DELETE和PUT一样不带验证机制（但与PUT方法相反），所以一般不使用
- OPTION：询问支持的方法，用来查询针对请求URI指定的资源支持的方法
- TRACE：追踪路径，让Web服务器端将之前的请求通信环回给客户端的方法
  发送请求时，在 Max-Forwards 首部字段中填入数值，每经过一个服务器端就将该数字减 1，当数值刚好减到 0 时，就停止继续传输，最后接收到请求的服务器端则返回状态码 200 OK 的响应。

- CONNECT：要求用隧道协议连接代理

## GET和POST区别

1. GET是获取数据，POST是修改数据 
2. POST比GET安全性高，通过GET提交的数据都将显示到URL上，页面会被浏览器缓存，其他人查看历史记录会看到提交的数据，而POST不会。另外GET提交数据还可能会造成CSRF攻击。
3. get提交的数据最大是2k（限制实际上取决于浏览器），post理论上没有限制
4. GET产生一个TCP数据包，浏览器会把HTTP header 和 data一并发送出去，服务器响应200（返回数据）； **(???)POST产生两个TCP数据包，浏览器先发送header，服务器响应100 continue，浏览器再发送data，服务器响应200 ok（返回数据）** 
5. GET请求会被浏览器主动缓存，而POST不会，除非手动设置 
6. GET请求只能进行url编码，而POST支持多种编码方式。 
7. GET请求参数会被完整保留在浏览器历史记录里，而POST中的参数不会被保留。

## POST 方法比 GET 方法安全？
相对来说 POST 比 GET 安全一些，因为 POST 数据在地址栏上不可见，但是从传输的角度来说，它们都是不安全的，因为 HTTP 在网络上是明文传输的，只要在网络节点上捉包，就能完整地获取数据报文。

要想安全传输，就只有加密，使用 HTTPS


## GET 方法的长度限制是怎么回事？

HTTP 协议没有 Body 和 URL 的长度限制，对 URL 限制的大多是浏览器和服务器的原因。

比如服务器因为处理长 URL 要消耗比较多的资源，为了性能和安全（防止恶意构造长 URL 来攻击）考虑，会给 URL 长度加限制。浏览器也是为性能和安全考虑所以对 URL 长度有所限制。

## POST 方法会产生两个TCP数据包？

HTTP 协议中没有明确说明 POST 会产生两个 TCP 数据包，而且实际测试(Chrome)发现，header 和 body 不会分开发送。

所以，header 和 body 分开发送是部分浏览器或框架的请求方法，不属于 post 必然行为。

